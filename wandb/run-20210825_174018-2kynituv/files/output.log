
Random Sampling
Train Epoch: 0 [2/65 (2%)] Loss: 10.126455: : 1it [00:00,  1.18it/s]
Training parameters: {'LOG_DIR': '../Proxy_Anchor/Newlogs', 'dataset': 'cub', 'sz_embedding': 512, 'sz_batch': 90, 'nb_epochs': 40, 'gpu_id': 1, 'nb_workers': 2, 'model': 'bn_inception', 'loss': 'Proxy_Anchor', 'optimizer': 'adamw', 'lr': 0.0001, 'mrg_lr': 0.0005, 'weight_decay': 0.0001, 'weight_lambda': 0.3, 'lr_decay_step': 10, 'lr_decay_gamma': 0.5, 'mrg_lr_decay_step': 10, 'mrg_lr_decay_gamma': 0.5, 'alphap': 32.0, 'alphan': 48.0, 'mrg': 0.0, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': '', 'delta': -0.1, 'T': 1.0, 'lam': 1.0}






Train Epoch: 0 [56/65 (85%)] Loss: 6.681302: : 56it [00:12,  4.80it/s]
Train Epoch: 0 [65/65 (98%)] Loss: 6.660237: : 65it [00:14,  4.38it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:15<00:00,  4.04it/s]
R@1 : 50.490
R@2 : 63.876
R@4 : 76.063
R@8 : 85.213
R@16 : 91.813
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  4.02it/s]







Train Epoch: 1 [63/65 (95%)] Loss: 5.917259: : 63it [00:15,  4.29it/s]
Train Epoch: 1 [65/65 (98%)] Loss: 6.209814: : 65it [00:15,  4.15it/s]







 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 62/66 [00:15<00:01,  3.91it/s]
R@1 : 59.858
R@2 : 72.046
R@4 : 81.752
R@8 : 88.639
R@16 : 93.467
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.96it/s]







Train Epoch: 2 [60/65 (91%)] Loss: 5.607382: : 60it [00:14,  4.40it/s]
Train Epoch: 2 [65/65 (98%)] Loss: 5.594664: : 65it [00:15,  4.18it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.90it/s]
R@1 : 60.635
R@2 : 72.232
R@4 : 81.803
R@8 : 89.534
R@16 : 94.311
R@32 : 97.012







Train Epoch: 3 [65/65 (98%)] Loss: 5.361649: : 65it [00:15,  4.17it/s]
**Evaluating...**







 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.87it/s]
R@1 : 63.302
R@2 : 74.646
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]
0it [00:00, ?it/s]
R@8 : 90.074
R@16 : 94.548







Train Epoch: 4 [59/65 (89%)] Loss: 5.173415: : 59it [00:14,  4.36it/s]
Train Epoch: 4 [65/65 (98%)] Loss: 5.245311: : 65it [00:15,  4.17it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:15<00:01,  4.32it/s]
R@1 : 63.774
R@2 : 74.966
R@4 : 83.795
R@8 : 90.614
R@16 : 94.818
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.82it/s]







Train Epoch: 5 [59/65 (89%)] Loss: 5.190017: : 59it [00:14,  4.23it/s]
Train Epoch: 5 [65/65 (98%)] Loss: 5.166181: : 65it [00:15,  4.13it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.88it/s]
R@1 : 63.994
R@2 : 75.219
R@4 : 83.103
R@8 : 89.990
R@16 : 94.429
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]







Train Epoch: 6 [62/65 (94%)] Loss: 5.081256: : 62it [00:14,  4.39it/s]
Train Epoch: 6 [65/65 (98%)] Loss: 5.075153: : 65it [00:15,  4.18it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.86it/s]
R@1 : 65.327
R@2 : 76.772
R@4 : 85.078
R@8 : 90.901
R@16 : 94.767
R@32 : 97.265






Train Epoch: 7 [65/65 (98%)] Loss: 4.954941: : 65it [00:15,  4.18it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.92it/s]
R@1 : 64.770
R@2 : 76.671
R@4 : 85.078
R@8 : 91.036
R@16 : 95.054
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.91it/s]







Train Epoch: 8 [63/65 (95%)] Loss: 5.022220: : 63it [00:15,  4.20it/s]
Train Epoch: 8 [65/65 (98%)] Loss: 4.968879: : 65it [00:15,  4.18it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.90it/s]
0it [00:00, ?it/s]
R@1 : 65.733
R@2 : 76.705
R@4 : 84.892
R@8 : 91.036
R@16 : 94.902







Train Epoch: 9 [65/65 (98%)] Loss: 4.911921: : 65it [00:15,  4.18it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:15<00:01,  3.88it/s]
R@1 : 67.066
R@2 : 77.431
R@4 : 86.158
R@8 : 91.442
R@16 : 95.206
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]







Train Epoch: 10 [60/65 (91%)] Loss: 4.894941: : 60it [00:14,  4.53it/s]
Train Epoch: 10 [65/65 (98%)] Loss: 4.837527: : 65it [00:15,  4.17it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.90it/s]
R@1 : 67.100
R@2 : 78.174
R@4 : 85.820
R@8 : 91.239
R@16 : 95.155
R@32 : 97.400






Train Epoch: 11 [65/65 (98%)] Loss: 4.885157: : 65it [00:15,  4.17it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]









 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 64/66 [00:18<00:00,  3.54it/s]
R@1 : 66.425
R@2 : 77.549
R@4 : 85.668
R@8 : 91.323
R@16 : 94.953
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:18<00:00,  3.54it/s]







Train Epoch: 12 [62/65 (94%)] Loss: 4.860101: : 62it [00:14,  4.38it/s]
Train Epoch: 12 [65/65 (98%)] Loss: 4.867846: : 65it [00:15,  4.16it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]
R@1 : 67.269
R@2 : 78.140
R@4 : 86.040
R@8 : 91.374
R@16 : 94.953
R@32 : 97.400







Train Epoch: 13 [64/65 (97%)] Loss: 4.908703: : 64it [00:15,  4.47it/s]
Train Epoch: 13 [65/65 (98%)] Loss: 4.885851: : 65it [00:15,  4.18it/s]







 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.84it/s]
R@1 : 67.539

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]
R@4 : 86.023
R@8 : 91.374
R@16 : 95.257
R@32 : 97.451







Train Epoch: 14 [64/65 (97%)] Loss: 4.868683: : 64it [00:15,  3.99it/s]
Train Epoch: 14 [65/65 (98%)] Loss: 4.899013: : 65it [00:16,  4.05it/s]







 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:15<00:01,  3.65it/s]
R@1 : 66.999
R@2 : 77.768
R@4 : 86.276
R@8 : 91.357
R@16 : 95.341
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.88it/s]







Train Epoch: 15 [61/65 (92%)] Loss: 4.801700: : 61it [00:14,  4.37it/s]
Train Epoch: 15 [65/65 (98%)] Loss: 4.844947: : 65it [00:15,  4.24it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.88it/s]
R@1 : 67.792
R@2 : 78.562
R@4 : 86.124
R@8 : 91.374
R@16 : 95.341
R@32 : 97.417






Train Epoch: 16 [65/65 (98%)] Loss: 4.889399: : 65it [00:15,  4.19it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 62/66 [00:15<00:00,  4.30it/s]
R@1 : 67.522
R@2 : 78.629
R@4 : 85.888
R@8 : 91.357
R@16 : 95.257
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]







Train Epoch: 17 [60/65 (91%)] Loss: 4.801394: : 60it [00:14,  4.35it/s]
Train Epoch: 17 [65/65 (98%)] Loss: 4.801352: : 65it [00:15,  4.12it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.61it/s]
R@1 : 67.066
R@2 : 77.481
R@4 : 85.702
R@8 : 91.442
R@16 : 95.375
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.88it/s]







Train Epoch: 18 [62/65 (94%)] Loss: 4.801759: : 62it [00:14,  4.34it/s]
Train Epoch: 18 [65/65 (98%)] Loss: 4.843565: : 65it [00:15,  4.14it/s]







 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:14<00:01,  4.06it/s]
R@1 : 67.353
R@2 : 78.140
R@4 : 85.854
R@8 : 91.695
R@16 : 95.307
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.98it/s]







Train Epoch: 19 [59/65 (89%)] Loss: 4.824893: : 59it [00:14,  4.21it/s]
Train Epoch: 19 [65/65 (98%)] Loss: 4.827758: : 65it [00:15,  4.15it/s]








 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 64/66 [00:16<00:00,  4.11it/s]
R@1 : 66.408
R@2 : 77.026
R@4 : 85.804
R@8 : 91.408
R@16 : 95.240
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.89it/s]







Train Epoch: 20 [64/65 (97%)] Loss: 4.817221: : 64it [00:15,  4.41it/s]
Train Epoch: 20 [65/65 (98%)] Loss: 4.793610: : 65it [00:15,  4.13it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]
R@1 : 66.796
R@2 : 78.477
R@4 : 86.074
R@8 : 91.695
R@16 : 95.375
R@32 : 97.586






Train Epoch: 21 [65/65 (98%)] Loss: 4.778530: : 65it [00:15,  4.19it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:15<00:01,  3.99it/s]
R@1 : 67.134
R@2 : 78.089
R@4 : 86.344
R@8 : 91.931
R@16 : 95.206
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.90it/s]







Train Epoch: 22 [61/65 (92%)] Loss: 4.789708: : 61it [00:14,  4.28it/s]
Train Epoch: 22 [65/65 (98%)] Loss: 4.782073: : 65it [00:15,  4.15it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  4.03it/s]
0it [00:00, ?it/s]
R@1 : 67.640
R@2 : 78.477
R@4 : 86.327
R@8 : 91.999
R@16 : 95.324







Train Epoch: 23 [61/65 (92%)] Loss: 4.812518: : 61it [00:14,  4.45it/s]
Train Epoch: 23 [65/65 (98%)] Loss: 4.819828: : 65it [00:15,  4.25it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]
R@1 : 66.712
R@2 : 77.718
R@4 : 86.124
R@8 : 91.577
R@16 : 95.240
R@32 : 97.333






Train Epoch: 24 [65/65 (98%)] Loss: 4.869339: : 65it [00:15,  4.17it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.86it/s]
0it [00:00, ?it/s]
R@1 : 67.201
R@2 : 78.663
R@4 : 86.563
R@8 : 91.830
R@16 : 95.476







Train Epoch: 25 [65/65 (98%)] Loss: 4.810524: : 65it [00:15,  4.14it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 64/66 [00:16<00:00,  4.20it/s]
R@1 : 67.319
R@2 : 78.444
R@4 : 86.090
R@8 : 91.745
R@16 : 95.206
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.91it/s]







Train Epoch: 26 [63/65 (95%)] Loss: 4.813940: : 63it [00:14,  4.37it/s]
Train Epoch: 26 [65/65 (98%)] Loss: 4.801140: : 65it [00:15,  4.20it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]
0it [00:00, ?it/s]
R@1 : 67.725
R@2 : 78.545
R@4 : 86.226
R@8 : 92.049
R@16 : 95.442







Train Epoch: 27 [61/65 (92%)] Loss: 4.831798: : 61it [00:14,  4.52it/s]
Train Epoch: 27 [65/65 (98%)] Loss: 4.772622: : 65it [00:15,  4.31it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:18<00:00,  3.65it/s]
0it [00:00, ?it/s]
R@1 : 67.623
R@2 : 78.646
R@4 : 86.259
R@8 : 91.847
R@16 : 95.206







Train Epoch: 28 [63/65 (95%)] Loss: 4.837180: : 63it [00:14,  4.35it/s]
Train Epoch: 28 [65/65 (98%)] Loss: 4.801195: : 65it [00:15,  4.32it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]
R@1 : 67.860
R@2 : 78.376
R@4 : 86.681
R@8 : 91.610
R@16 : 95.324
R@32 : 97.333







Train Epoch: 29 [62/65 (94%)] Loss: 4.791845: : 62it [00:15,  4.24it/s]
Train Epoch: 29 [65/65 (98%)] Loss: 4.812343: : 65it [00:15,  4.09it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.82it/s]
R@1 : 67.623
R@2 : 78.275
R@4 : 86.529
R@8 : 91.830
R@16 : 95.105
R@32 : 97.350






Train Epoch: 30 [65/65 (98%)] Loss: 4.794157: : 65it [00:15,  4.25it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.93it/s]
R@1 : 68.130
R@2 : 78.731
R@4 : 86.242
R@8 : 91.762
R@16 : 95.240
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.90it/s]







Train Epoch: 31 [63/65 (95%)] Loss: 4.781662: : 63it [00:14,  4.25it/s]
Train Epoch: 31 [65/65 (98%)] Loss: 4.788879: : 65it [00:15,  4.20it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.89it/s]
0it [00:00, ?it/s]
R@1 : 67.961
R@2 : 78.866
R@4 : 86.563
R@8 : 91.880
R@16 : 95.223







Train Epoch: 32 [65/65 (98%)] Loss: 4.812153: : 65it [00:15,  4.21it/s]
  2%|██▏                                                                                                                                             | 1/66 [00:00<00:45,  1.42it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.71it/s]
0it [00:00, ?it/s]
R@1 : 67.775
R@2 : 78.697
R@4 : 86.732
R@8 : 91.914
R@16 : 95.155







Train Epoch: 33 [65/65 (98%)] Loss: 4.825599: : 65it [00:15,  4.08it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:15<00:01,  3.88it/s]
R@1 : 67.117
R@2 : 78.511
R@4 : 86.310
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]
0it [00:00, ?it/s]
R@16 : 95.155







Train Epoch: 34 [61/65 (92%)] Loss: 4.820517: : 61it [00:14,  4.27it/s]
Train Epoch: 34 [65/65 (98%)] Loss: 4.777971: : 65it [00:15,  4.18it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.89it/s]
R@1 : 67.302
R@2 : 78.545
R@4 : 86.681
R@8 : 91.914
R@16 : 95.307
R@32 : 97.367






Train Epoch: 35 [65/65 (98%)] Loss: 4.789297: : 65it [00:15,  4.21it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.87it/s]
R@1 : 67.454
R@2 : 78.866
R@4 : 86.428
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.89it/s]
Train Epoch: 36 [2/65 (2%)] Loss: 4.778934: : 2it [00:00,  2.37it/s]
R@16 : 95.189







Train Epoch: 36 [62/65 (94%)] Loss: 4.796804: : 62it [00:14,  4.43it/s]
Train Epoch: 36 [65/65 (98%)] Loss: 4.765566: : 65it [00:15,  4.16it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]
R@1 : 67.910
R@2 : 78.967
R@4 : 86.918
R@8 : 92.134
R@16 : 95.324
R@32 : 97.502







Train Epoch: 37 [64/65 (97%)] Loss: 4.811731: : 64it [00:15,  4.39it/s]
Train Epoch: 37 [65/65 (98%)] Loss: 4.781605: : 65it [00:15,  4.12it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.87it/s]
0it [00:00, ?it/s]
R@1 : 67.640
R@2 : 78.241
R@4 : 86.749
R@8 : 92.016
R@16 : 95.459







Train Epoch: 38 [65/65 (98%)] Loss: 4.801425: : 65it [00:15,  4.15it/s]
  2%|██▏                                                                                                                                             | 1/66 [00:00<00:45,  1.44it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.88it/s]
R@1 : 67.927
R@2 : 78.292
R@4 : 86.614
R@8 : 91.762
R@16 : 95.273
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.86it/s]







Train Epoch: 39 [64/65 (97%)] Loss: 4.795772: : 64it [00:15,  4.24it/s]
Train Epoch: 39 [65/65 (98%)] Loss: 4.776583: : 65it [00:15,  4.21it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.88it/s]
R@1 : 67.573
R@2 : 78.174
R@4 : 86.377
R@8 : 92.100
R@16 : 95.409
R@32 : 97.384