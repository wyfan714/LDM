
Random Sampling
0it [00:00, ?it/s]
Training parameters: {'LOG_DIR': '../Proxy_Anchor/Newlogs', 'dataset': 'SOP', 'sz_embedding': 1024, 'sz_batch': 90, 'nb_epochs': 60, 'gpu_id': 1, 'nb_workers': 2, 'model': 'bn_inception', 'loss': 'Proxy_Anchor', 'optimizer': 'adamw', 'lr': 0.0006, 'mrg_lr': 0.0001, 'weight_decay': 0.0001, 'weight_lambda': 0.3, 'lr_decay_step': 20, 'lr_decay_gamma': 0.25, 'mrg_lr_decay_step': 10, 'mrg_lr_decay_gamma': 0.5, 'alphap': 32, 'alphan': 32, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 0, 'l2_norm': 1, 'remark': '', 'delta': 0.1, 'T': 1.0, 'lam': 1.0}









































































































































































































































































































Train Epoch: 0 [659/661 (100%)] Loss: 18.793011: : 659it [09:54,  1.11it/s]
Train Epoch: 0 [661/661 (100%)] Loss: 18.081682: : 661it [09:56,  1.11it/s]































































100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 673/673 [02:06<00:00,  5.32it/s]
R@1 : 51.889
R@10 : 68.366
R@100 : 82.143
R@1000 : 93.721


































































































































































































































































































































































Train Epoch: 1 [660/661 (100%)] Loss: 15.655616: : 660it [11:49,  1.07s/it]
Train Epoch: 1 [661/661 (100%)] Loss: 16.447535: : 661it [11:50,  1.07s/it]

































































100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 673/673 [02:11<00:00,  5.12it/s]
Traceback (most recent call last):
  File "train.py", line 505, in <module>
    main()
  File "train.py", line 464, in main
    Recalls = utils.evaluate_cos_SOP(model, dl_ev)
  File "/home/wyf/Proxy_Anchor/utils.py", line 148, in evaluate_cos_SOP
    cos_sim = F.linear(xs,X)
  File "/home/wyf/anaconda3/envs/proxyanchor/lib/python3.8/site-packages/torch/nn/functional.py", line 1753, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: CUDA out of memory. Tried to allocate 2.26 GiB (GPU 1; 10.76 GiB total capacity; 2.88 GiB already allocated; 2.11 GiB free; 7.61 GiB reserved in total by PyTorch)