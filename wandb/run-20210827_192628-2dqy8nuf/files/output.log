
Random Sampling
Training parameters: {'LOG_DIR': '../Proxy_Anchor/Newlogs', 'dataset': 'cars', 'sz_embedding': 512, 'sz_batch': 90, 'nb_epochs': 40, 'gpu_id': 1, 'nb_workers': 2, 'model': 'bn_inception', 'loss': 'Proxy_Anchor', 'optimizer': 'adamw', 'lr': 0.0001, 'mrg_lr': 0.0001, 'weight_decay': 0.0001, 'weight_lambda': 0.3, 'lr_decay_step': 10, 'lr_decay_gamma': 0.5, 'mrg_lr_decay_step': 10, 'mrg_lr_decay_gamma': 0.5, 'alphap': 48.0, 'alphan': 48.0, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': '', 'delta': 0.1, 'T': 1.0, 'lam': 1.0}
Training for 40 epochs.

















Train Epoch: 0 [85/89 (94%)] Loss: 16.766865: : 85it [00:34,  2.60it/s]
Train Epoch: 0 [89/89 (99%)] Loss: 16.986458: : 89it [00:36,  2.47it/s]





















 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 87/91 [00:42<00:01,  2.31it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.05it/s]
R@2 : 56.500
R@4 : 68.306
R@8 : 79.572
R@16 : 88.193
R@32 : 94.564
















Train Epoch: 1 [85/89 (94%)] Loss: 15.735634: : 85it [00:33,  2.65it/s]
Train Epoch: 1 [89/89 (99%)] Loss: 15.421950: : 89it [00:35,  2.54it/s]






















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:43<00:02,  1.88it/s]
R@1 : 62.514
R@2 : 73.558
R@4 : 82.339
R@8 : 89.325
R@16 : 94.269
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  2.00it/s]

















Train Epoch: 2 [89/89 (99%)] Loss: 15.065346: : 89it [00:36,  2.45it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:43<00:02,  1.73it/s]
R@1 : 72.550
R@2 : 81.970
R@4 : 88.710
R@8 : 93.396
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  2.00it/s]
0it [00:00, ?it/s]

















Train Epoch: 3 [89/89 (99%)] Loss: 13.302731: : 89it [00:35,  2.48it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:43<00:02,  1.69it/s]
R@1 : 74.935
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  1.99it/s]
0it [00:00, ?it/s]
R@4 : 89.731
R@8 : 93.715
R@16 : 96.753


















Train Epoch: 4 [88/89 (98%)] Loss: 12.117336: : 88it [00:35,  2.70it/s]
Train Epoch: 4 [89/89 (99%)] Loss: 12.758301: : 89it [00:36,  2.46it/s]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:43<00:02,  1.83it/s]
R@1 : 76.903

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  2.02it/s]
R@4 : 90.887
R@8 : 94.662
R@16 : 97.307
R@32 : 98.733

















Train Epoch: 5 [88/89 (98%)] Loss: 12.621586: : 88it [00:35,  2.91it/s]
Train Epoch: 5 [89/89 (99%)] Loss: 12.292683: : 89it [00:36,  2.45it/s]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:42<00:02,  1.81it/s]
R@1 : 79.498
R@2 : 87.419
R@4 : 92.055
R@8 : 95.548
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.04it/s]
0it [00:00, ?it/s]


















Train Epoch: 6 [87/89 (97%)] Loss: 11.567787: : 87it [00:35,  2.74it/s]
Train Epoch: 6 [89/89 (99%)] Loss: 11.674490: : 89it [00:36,  2.42it/s]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:42<00:02,  1.72it/s]
R@1 : 80.814
R@2 : 88.033
R@4 : 92.596
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.04it/s]
0it [00:00, ?it/s]
R@16 : 97.676


















Train Epoch: 7 [86/89 (96%)] Loss: 10.835296: : 86it [00:35,  2.76it/s]
Train Epoch: 7 [89/89 (99%)] Loss: 11.070797: : 89it [00:37,  2.38it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.05it/s]
R@1 : 81.072
R@2 : 88.513
R@4 : 92.719
R@8 : 95.831
R@16 : 97.860
R@32 : 98.992
















Train Epoch: 8 [84/89 (93%)] Loss: 10.986111: : 84it [00:33,  2.97it/s]
Train Epoch: 8 [89/89 (99%)] Loss: 10.626987: : 89it [00:35,  2.52it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.07it/s]
R@1 : 82.019
R@2 : 88.821
R@4 : 93.211
R@8 : 96.261
R@16 : 97.909
R@32 : 98.869
















Train Epoch: 9 [85/89 (94%)] Loss: 9.877888: : 85it [00:33,  2.73it/s]
Train Epoch: 9 [89/89 (99%)] Loss: 10.556458: : 89it [00:35,  2.52it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
R@1 : 83.028
R@2 : 89.485
R@4 : 93.715
R@8 : 96.298
R@16 : 97.799
R@32 : 98.905
















Train Epoch: 10 [89/89 (99%)] Loss: 9.810347: : 89it [00:35,  2.48it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 90/91 [00:43<00:00,  2.14it/s]
R@1 : 84.024
R@2 : 90.247
R@4 : 94.355
R@8 : 96.839
R@16 : 98.143
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.08it/s]

















Train Epoch: 11 [87/89 (97%)] Loss: 8.414506: : 87it [00:35,  2.76it/s]
Train Epoch: 11 [89/89 (99%)] Loss: 9.208853: : 89it [00:36,  2.45it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.03it/s]
R@1 : 84.565
R@2 : 90.739
R@4 : 94.429
R@8 : 96.753
R@16 : 98.168
R@32 : 99.016

















Train Epoch: 12 [87/89 (97%)] Loss: 8.681886: : 87it [00:35,  2.23it/s]
Train Epoch: 12 [89/89 (99%)] Loss: 9.378141: : 89it [00:36,  2.44it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  2.77it/s]
R@1 : 84.971
R@2 : 91.071
R@4 : 94.699
R@8 : 96.876
R@16 : 98.266
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  2.00it/s]

















Train Epoch: 13 [87/89 (97%)] Loss: 8.260871: : 87it [00:35,  2.68it/s]
Train Epoch: 13 [89/89 (99%)] Loss: 8.699608: : 89it [00:35,  2.48it/s]






















 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 88/91 [00:45<00:01,  1.73it/s]
R@1 : 85.082
R@2 : 90.874
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  1.98it/s]
Train Epoch: 14 [1/89 (0%)] Loss: 8.786383: : 1it [00:00,  1.03it/s]
R@8 : 96.716
R@16 : 98.278

















Train Epoch: 14 [87/89 (97%)] Loss: 7.698193: : 87it [00:34,  2.94it/s]
Train Epoch: 14 [89/89 (99%)] Loss: 8.078697: : 89it [00:35,  2.50it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.04it/s]
R@1 : 85.291
R@2 : 91.194
R@4 : 94.675
R@8 : 96.950
R@16 : 98.327
R@32 : 99.078
















Train Epoch: 15 [89/89 (99%)] Loss: 8.450165: : 89it [00:35,  2.51it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 89/91 [00:44<00:01,  1.90it/s]
R@1 : 85.045
R@2 : 91.034
R@4 : 94.539
R@8 : 96.962
R@16 : 98.266
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.03it/s]
















Train Epoch: 16 [89/89 (99%)] Loss: 8.355186: : 89it [00:35,  2.54it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
R@1 : 84.688
R@2 : 90.985
R@4 : 94.466
R@8 : 96.741
R@16 : 98.229
R@32 : 99.078
















Train Epoch: 17 [89/89 (99%)] Loss: 7.995976: : 89it [00:34,  2.58it/s]
  1%|█▌                                                                                                                                              | 1/91 [00:01<01:38,  1.09s/it]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.07it/s]
0it [00:00, ?it/s]
R@1 : 85.918
R@2 : 91.465
R@4 : 94.798
R@8 : 97.159
R@16 : 98.364

















Train Epoch: 18 [89/89 (99%)] Loss: 8.184818: : 89it [00:35,  2.50it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:46<00:00,  1.97it/s]
0it [00:00, ?it/s]
R@1 : 85.623
R@2 : 91.317
R@4 : 94.945
R@8 : 97.048
R@16 : 98.438

















Train Epoch: 19 [89/89 (99%)] Loss: 7.951533: : 89it [00:35,  2.51it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.08it/s]
0it [00:00, ?it/s]
R@1 : 85.389
R@2 : 90.911
R@4 : 94.466
R@8 : 96.925
R@16 : 98.290

















Train Epoch: 20 [89/89 (99%)] Loss: 7.863935: : 89it [00:35,  2.50it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.09it/s]
0it [00:00, ?it/s]
R@1 : 85.697
R@2 : 91.465
R@4 : 94.724
R@8 : 97.233
R@16 : 98.377

















Train Epoch: 21 [89/89 (99%)] Loss: 7.425728: : 89it [00:36,  2.44it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.07it/s]
R@1 : 86.139
R@2 : 91.698
R@4 : 94.982
R@8 : 97.221
R@16 : 98.327
R@32 : 99.127
















Train Epoch: 22 [89/89 (99%)] Loss: 6.602842: : 89it [00:34,  2.58it/s]
  1%|█▌                                                                                                                                              | 1/91 [00:01<01:36,  1.07s/it]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
0it [00:00, ?it/s]
R@1 : 86.312
R@2 : 91.969
R@4 : 95.314
R@8 : 97.245
R@16 : 98.413

















Train Epoch: 23 [89/89 (99%)] Loss: 7.349128: : 89it [00:36,  2.47it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.07it/s]
R@1 : 86.016
R@2 : 91.858
R@4 : 95.228
R@8 : 97.171
R@16 : 98.315
R@32 : 99.102

















Train Epoch: 24 [89/89 (99%)] Loss: 6.963179: : 89it [00:36,  2.43it/s]
  1%|█▌                                                                                                                                              | 1/91 [00:01<01:36,  1.07s/it]





















 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 90/91 [00:43<00:00,  2.18it/s]
R@1 : 85.721
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.10it/s]
Train Epoch: 25 [2/89 (1%)] Loss: 7.449074: : 2it [00:01,  1.77it/s]
R@4 : 95.068
R@8 : 97.257
R@16 : 98.586
















Train Epoch: 25 [89/89 (99%)] Loss: 7.302744: : 89it [00:34,  2.59it/s]
  1%|█▌                                                                                                                                              | 1/91 [00:01<01:37,  1.09s/it]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.07it/s]
0it [00:00, ?it/s]
R@1 : 86.066
R@2 : 91.711
R@4 : 94.908
R@8 : 97.122
R@16 : 98.426

















Train Epoch: 26 [89/89 (99%)] Loss: 6.909406: : 89it [00:35,  2.51it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
R@1 : 86.496
R@2 : 91.858
R@4 : 95.253
R@8 : 97.270
R@16 : 98.512
R@32 : 99.176

















Train Epoch: 27 [89/89 (99%)] Loss: 7.432175: : 89it [00:36,  2.46it/s]
  1%|█▌                                                                                                                                              | 1/91 [00:01<01:36,  1.08s/it]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.08it/s]
Train Epoch: 28 [2/89 (1%)] Loss: 7.289882: : 2it [00:01,  1.71it/s]
R@1 : 86.176
R@2 : 91.846
R@4 : 95.056
R@8 : 97.208
R@16 : 98.327
















Train Epoch: 28 [86/89 (96%)] Loss: 6.793595: : 86it [00:33,  2.66it/s]
Train Epoch: 28 [89/89 (99%)] Loss: 6.958549: : 89it [00:34,  2.59it/s]





















 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 89/91 [00:43<00:00,  2.15it/s]
R@1 : 86.201
R@2 : 91.895
R@4 : 95.117
R@8 : 97.319
R@16 : 98.290
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.08it/s]

















Train Epoch: 29 [88/89 (98%)] Loss: 7.062458: : 88it [00:35,  2.79it/s]
Train Epoch: 29 [89/89 (99%)] Loss: 7.386573: : 89it [00:35,  2.49it/s]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:42<00:02,  1.76it/s]
R@1 : 86.521
R@2 : 91.994
R@4 : 95.228
R@8 : 97.134
R@16 : 98.512
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.07it/s]

















Train Epoch: 30 [87/89 (97%)] Loss: 7.916807: : 87it [00:34,  2.25it/s]
Train Epoch: 30 [89/89 (99%)] Loss: 6.605221: : 89it [00:35,  2.54it/s]





















 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 88/91 [00:43<00:01,  1.74it/s]
R@1 : 86.472
R@2 : 92.141
R@4 : 95.216
R@8 : 97.221
R@16 : 98.327
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
















Train Epoch: 31 [89/89 (99%)] Loss: 6.986270: : 89it [00:35,  2.54it/s]
  0%|                                                                                                                                                        | 0/91 [00:00<?, ?it/s]






















 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 90/91 [00:44<00:00,  2.07it/s]
R@1 : 86.373
R@2 : 91.821
R@4 : 95.327
R@8 : 97.319
R@16 : 98.401
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]

















Train Epoch: 32 [88/89 (98%)] Loss: 6.414940: : 88it [00:35,  2.55it/s]
Train Epoch: 32 [89/89 (99%)] Loss: 6.510493: : 89it [00:35,  2.47it/s]





















 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 88/91 [00:43<00:01,  1.74it/s]
R@1 : 86.545
R@2 : 92.006
R@4 : 95.339
R@8 : 97.344
R@16 : 98.450
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]

















Train Epoch: 33 [86/89 (96%)] Loss: 7.510587: : 86it [00:33,  2.63it/s]
Train Epoch: 33 [89/89 (99%)] Loss: 6.884429: : 89it [00:35,  2.54it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:45<00:00,  2.01it/s]
R@1 : 86.508
R@2 : 91.969
R@4 : 95.204
R@8 : 97.221
R@16 : 98.450
R@32 : 99.201

















Train Epoch: 34 [87/89 (97%)] Loss: 6.714805: : 87it [00:35,  3.06it/s]
Train Epoch: 34 [89/89 (99%)] Loss: 6.353098: : 89it [00:35,  2.47it/s]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.10it/s]
R@1 : 86.066
R@2 : 91.834
R@4 : 95.007
R@8 : 97.282
R@16 : 98.438
R@32 : 99.164
















Train Epoch: 35 [85/89 (94%)] Loss: 7.045931: : 85it [00:33,  2.87it/s]
Train Epoch: 35 [89/89 (99%)] Loss: 7.115277: : 89it [00:35,  2.52it/s]





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
R@1 : 86.189
R@2 : 91.809
R@4 : 95.290
R@8 : 97.380
R@16 : 98.536
R@32 : 99.213
















Train Epoch: 36 [86/89 (96%)] Loss: 6.413857: : 86it [00:33,  2.61it/s]
Train Epoch: 36 [89/89 (99%)] Loss: 7.112327: : 89it [00:34,  2.57it/s]





















 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 86/91 [00:42<00:02,  1.93it/s]
R@1 : 86.619
R@2 : 92.006
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
0it [00:00, ?it/s]
R@8 : 97.430
R@16 : 98.438

















Train Epoch: 37 [86/89 (96%)] Loss: 6.293054: : 86it [00:33,  2.45it/s]
Train Epoch: 37 [89/89 (99%)] Loss: 6.623297: : 89it [00:35,  2.53it/s]






















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.03it/s]
R@1 : 86.619
R@2 : 92.252
R@4 : 95.388
R@8 : 97.294
R@16 : 98.450
R@32 : 99.237

















Train Epoch: 38 [89/89 (99%)] Loss: 6.407872: : 89it [00:35,  2.49it/s]
**Evaluating...**





















100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:43<00:00,  2.09it/s]
R@1 : 86.508
R@2 : 92.227
R@4 : 95.363
R@8 : 97.479
R@16 : 98.549
R@32 : 99.201
















Train Epoch: 39 [87/89 (97%)] Loss: 6.639298: : 87it [00:33,  3.12it/s]
Train Epoch: 39 [89/89 (99%)] Loss: 7.006667: : 89it [00:34,  2.58it/s]





















 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 89/91 [00:43<00:00,  2.24it/s]
R@1 : 86.521
R@2 : 91.969
R@4 : 95.314
R@8 : 97.233

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:44<00:00,  2.06it/s]
R@32 : 99.201