
Random Sampling
Training parameters: {'LOG_DIR': '../Proxy_Anchor/Newlogs', 'dataset': 'cub', 'sz_embedding': 512, 'sz_batch': 90, 'nb_epochs': 40, 'gpu_id': 1, 'nb_workers': 2, 'model': 'bn_inception', 'loss': 'Proxy_Anchor', 'optimizer': 'adamw', 'lr': 0.0001, 'mrg_lr': 0.0005, 'weight_decay': 0.0001, 'weight_lambda': 0.3, 'lr_decay_step': 10, 'lr_decay_gamma': 0.5, 'mrg_lr_decay_step': 10, 'mrg_lr_decay_gamma': 0.5, 'alphap': 32.0, 'alphan': 40.0, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': '', 'delta': 0.1, 'T': 1.0, 'lam': 1.0}
Training for 40 epochs.







Train Epoch: 0 [63/65 (95%)] Loss: 12.411963: : 63it [00:14,  4.54it/s]
Train Epoch: 0 [65/65 (98%)] Loss: 12.302706: : 65it [00:15,  4.26it/s]







 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████             | 60/66 [00:15<00:01,  4.44it/s]
R@1 : 50.641
R@2 : 64.061
R@4 : 76.283
R@8 : 85.280
R@16 : 91.796
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:16<00:00,  3.93it/s]







Train Epoch: 1 [58/65 (88%)] Loss: 10.681681: : 58it [00:14,  4.28it/s]
Train Epoch: 1 [65/65 (98%)] Loss: 11.202112: : 65it [00:15,  4.08it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.78it/s]
R@1 : 61.175
R@2 : 72.265
R@4 : 81.634
R@8 : 88.842
R@16 : 94.142
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]







Train Epoch: 2 [65/65 (98%)] Loss: 9.565430: : 65it [00:16,  3.99it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.77it/s]
R@1 : 63.268
R@2 : 74.713
R@4 : 83.693
R@8 : 90.125
R@16 : 94.598
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]







Train Epoch: 3 [65/65 (98%)] Loss: 8.654800: : 65it [00:16,  4.03it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.87it/s]
R@1 : 64.517
R@2 : 75.557
R@4 : 84.132
R@8 : 90.733
R@16 : 94.733
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.84it/s]







Train Epoch: 4 [65/65 (98%)] Loss: 8.089108: : 65it [00:16,  4.00it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.93it/s]
R@1 : 64.787
R@2 : 75.962
R@4 : 84.301
R@8 : 90.530
R@16 : 94.564

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]







Train Epoch: 5 [63/65 (95%)] Loss: 7.263994: : 63it [00:15,  4.05it/s]
Train Epoch: 5 [65/65 (98%)] Loss: 7.751933: : 65it [00:16,  3.96it/s]







 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.87it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]
R@2 : 75.051
R@4 : 83.575
R@8 : 90.159
R@16 : 94.328
R@32 : 97.063







Train Epoch: 6 [64/65 (97%)] Loss: 7.057148: : 64it [00:15,  4.35it/s]
Train Epoch: 6 [65/65 (98%)] Loss: 7.137646: : 65it [00:16,  4.04it/s]







 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.82it/s]
R@1 : 66.104
R@2 : 76.992
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]
0it [00:00, ?it/s]
R@8 : 90.733
R@16 : 94.953








Train Epoch: 7 [64/65 (97%)] Loss: 6.886699: : 64it [00:16,  4.38it/s]
Train Epoch: 7 [65/65 (98%)] Loss: 6.657528: : 65it [00:16,  3.97it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]
R@1 : 66.256
R@2 : 76.604
R@4 : 85.331
R@8 : 91.121
R@16 : 94.733
R@32 : 97.029






Train Epoch: 8 [65/65 (98%)] Loss: 6.358321: : 65it [00:15,  4.11it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]









100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.69it/s]
R@1 : 67.640
R@2 : 77.785
R@4 : 85.415
R@8 : 91.188
R@16 : 94.970
R@32 : 97.130







Train Epoch: 9 [62/65 (94%)] Loss: 6.328092: : 62it [00:15,  4.39it/s]
Train Epoch: 9 [65/65 (98%)] Loss: 6.463706: : 65it [00:16,  4.05it/s]








 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 65/66 [00:17<00:00,  3.80it/s]
R@1 : 66.644
R@2 : 77.397
R@4 : 85.635
R@8 : 91.020
R@16 : 94.835
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]







Train Epoch: 10 [61/65 (92%)] Loss: 6.069248: : 61it [00:15,  4.10it/s]
Train Epoch: 10 [65/65 (98%)] Loss: 5.895307: : 65it [00:16,  3.99it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.74it/s]
R@1 : 67.117
R@2 : 77.296
R@4 : 85.618
R@8 : 90.969
R@16 : 94.868
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]







Train Epoch: 11 [62/65 (94%)] Loss: 6.124520: : 62it [00:15,  4.30it/s]
Train Epoch: 11 [65/65 (98%)] Loss: 5.954309: : 65it [00:16,  4.02it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.85it/s]
R@1 : 67.252
R@2 : 77.785
R@4 : 85.939
R@8 : 91.239
R@16 : 94.750
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]







Train Epoch: 12 [62/65 (94%)] Loss: 5.945868: : 62it [00:15,  4.19it/s]
Train Epoch: 12 [65/65 (98%)] Loss: 5.976703: : 65it [00:16,  4.06it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]
R@1 : 66.999
R@2 : 77.431
R@4 : 85.517
R@8 : 90.834
R@16 : 94.767
R@32 : 97.367







Train Epoch: 13 [62/65 (94%)] Loss: 6.187265: : 62it [00:15,  4.40it/s]
Train Epoch: 13 [65/65 (98%)] Loss: 5.891422: : 65it [00:16,  4.01it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.79it/s]
R@1 : 67.454
R@2 : 78.157
R@4 : 85.955
R@8 : 91.475
R@16 : 95.240
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]







Train Epoch: 14 [63/65 (95%)] Loss: 6.060814: : 63it [00:15,  4.33it/s]
Train Epoch: 14 [65/65 (98%)] Loss: 5.868898: : 65it [00:15,  4.07it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
R@1 : 67.522
R@2 : 77.988
R@4 : 86.192
R@8 : 91.374
R@16 : 95.138
R@32 : 97.198







Train Epoch: 15 [64/65 (97%)] Loss: 6.113067: : 64it [00:15,  4.39it/s]
Train Epoch: 15 [65/65 (98%)] Loss: 5.776017: : 65it [00:15,  4.10it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.85it/s]
R@1 : 66.712
R@2 : 77.988
R@4 : 86.226
R@8 : 91.729
R@16 : 95.358
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]







Train Epoch: 16 [63/65 (95%)] Loss: 5.766250: : 63it [00:15,  4.04it/s]
Train Epoch: 16 [65/65 (98%)] Loss: 5.989626: : 65it [00:15,  4.08it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:17<00:00,  3.72it/s]
R@1 : 66.847
R@2 : 78.106
R@4 : 86.226
R@8 : 91.813
R@16 : 95.122
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.72it/s]







Train Epoch: 17 [63/65 (95%)] Loss: 5.908638: : 63it [00:15,  4.22it/s]
Train Epoch: 17 [65/65 (98%)] Loss: 5.505975: : 65it [00:15,  4.09it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]
R@1 : 66.458
R@2 : 77.532
R@4 : 85.652
R@8 : 91.458
R@16 : 94.885
R@32 : 97.130







Train Epoch: 18 [64/65 (97%)] Loss: 5.708747: : 64it [00:15,  4.27it/s]
Train Epoch: 18 [65/65 (98%)] Loss: 5.742735: : 65it [00:15,  4.08it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]
R@1 : 67.826
R@2 : 78.207
R@4 : 86.090
R@8 : 91.594
R@16 : 94.970
R@32 : 97.232







Train Epoch: 19 [64/65 (97%)] Loss: 5.643233: : 64it [00:15,  4.39it/s]
Train Epoch: 19 [65/65 (98%)] Loss: 5.669959: : 65it [00:15,  4.09it/s]







 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████             | 60/66 [00:15<00:01,  3.58it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]
R@2 : 78.022
R@4 : 85.787
R@8 : 91.729
R@16 : 95.054
R@32 : 97.282







Train Epoch: 20 [65/65 (98%)] Loss: 5.450944: : 65it [00:16,  3.84it/s]
Train Epoch: 20 [65/65 (98%)] Loss: 5.450944: : 65it [00:16,  4.04it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.70it/s]
R@1 : 67.235
R@2 : 78.055
R@4 : 86.411
R@8 : 91.729
R@16 : 95.138
R@32 : 97.232







Train Epoch: 21 [63/65 (95%)] Loss: 5.407828: : 63it [00:15,  4.21it/s]
Train Epoch: 21 [65/65 (98%)] Loss: 5.368074: : 65it [00:16,  4.02it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
R@1 : 67.319
R@2 : 77.971
R@4 : 85.972
R@8 : 91.475
R@16 : 95.206
R@32 : 97.519







Train Epoch: 22 [64/65 (97%)] Loss: 5.603087: : 64it [00:15,  4.35it/s]
Train Epoch: 22 [65/65 (98%)] Loss: 5.338506: : 65it [00:16,  4.05it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.73it/s]
R@1 : 68.096
R@2 : 78.325
R@4 : 86.006
R@8 : 91.594
R@16 : 95.105
R@32 : 97.350







Train Epoch: 23 [59/65 (89%)] Loss: 5.436440: : 59it [00:14,  4.05it/s]
Train Epoch: 23 [65/65 (98%)] Loss: 5.551073: : 65it [00:16,  3.95it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.77it/s]
R@1 : 67.623
R@2 : 77.330
R@4 : 85.972
R@8 : 91.458
R@16 : 95.020
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]







Train Epoch: 24 [65/65 (98%)] Loss: 5.683912: : 65it [00:16,  4.05it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.86it/s]
R@1 : 67.775
R@2 : 78.005
R@4 : 86.276
R@8 : 91.745
R@16 : 95.223
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.85it/s]







Train Epoch: 25 [65/65 (98%)] Loss: 5.489757: : 65it [00:16,  3.94it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.82it/s]
R@1 : 67.218
R@2 : 77.515
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.82it/s]
Train Epoch: 26 [1/65 (0%)] Loss: 5.501238: : 1it [00:00,  1.37it/s]
R@8 : 91.661
R@16 : 95.172







Train Epoch: 26 [65/65 (98%)] Loss: 5.476160: : 65it [00:16,  4.00it/s]
  2%|██▏                                                                                                                                             | 1/66 [00:00<00:44,  1.46it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]
0it [00:00, ?it/s]
R@1 : 68.163
R@2 : 78.629
R@4 : 86.411
R@8 : 91.914
R@16 : 95.375







Train Epoch: 27 [65/65 (98%)] Loss: 5.273900: : 65it [00:16,  4.02it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.72it/s]
0it [00:00, ?it/s]
R@1 : 68.400
R@2 : 78.005
R@4 : 85.939
R@8 : 91.644
R@16 : 95.307








Train Epoch: 28 [63/65 (95%)] Loss: 5.513811: : 63it [00:15,  3.93it/s]
Train Epoch: 28 [65/65 (98%)] Loss: 5.454072: : 65it [00:16,  4.00it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]
R@1 : 68.467
R@2 : 78.477
R@4 : 86.209
R@8 : 91.745
R@16 : 95.324
R@32 : 97.316







Train Epoch: 29 [62/65 (94%)] Loss: 5.431665: : 62it [00:15,  4.25it/s]
Train Epoch: 29 [65/65 (98%)] Loss: 5.554647: : 65it [00:16,  4.00it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  4.02it/s]
R@1 : 67.657
R@2 : 78.511
R@4 : 86.377
R@8 : 91.695
R@16 : 95.442
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]







Train Epoch: 30 [64/65 (97%)] Loss: 5.325319: : 64it [00:15,  4.18it/s]
Train Epoch: 30 [65/65 (98%)] Loss: 5.385979: : 65it [00:15,  4.13it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
R@1 : 68.653
R@2 : 78.663
R@4 : 86.327
R@8 : 91.897
R@16 : 95.375
R@32 : 97.569







Train Epoch: 31 [64/65 (97%)] Loss: 5.306849: : 64it [00:15,  4.37it/s]
Train Epoch: 31 [65/65 (98%)] Loss: 5.378537: : 65it [00:16,  4.04it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]
0it [00:00, ?it/s]
R@1 : 68.670
R@2 : 78.477
R@4 : 86.124
R@8 : 91.560
R@16 : 95.257







Train Epoch: 32 [65/65 (98%)] Loss: 5.430922: : 65it [00:15,  4.08it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.74it/s]
0it [00:00, ?it/s]
R@1 : 68.433
R@2 : 78.714
R@4 : 86.259
R@8 : 91.610
R@16 : 95.223








Train Epoch: 33 [63/65 (95%)] Loss: 5.266954: : 63it [00:15,  4.19it/s]
Train Epoch: 33 [65/65 (98%)] Loss: 5.541587: : 65it [00:15,  4.07it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.93it/s]
R@1 : 68.585
R@2 : 78.477
R@4 : 86.175
R@8 : 91.880
R@16 : 95.409
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.71it/s]







Train Epoch: 34 [63/65 (95%)] Loss: 5.375943: : 63it [00:15,  4.31it/s]
Train Epoch: 34 [65/65 (98%)] Loss: 5.335622: : 65it [00:15,  4.11it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
R@1 : 67.741
R@2 : 78.309
R@4 : 86.462
R@8 : 91.627
R@16 : 95.459
R@32 : 97.417






Train Epoch: 35 [65/65 (98%)] Loss: 5.405596: : 65it [00:15,  4.10it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]
0it [00:00, ?it/s]
R@1 : 67.978
R@2 : 77.752
R@4 : 86.074
R@8 : 91.661
R@16 : 95.476







Train Epoch: 36 [65/65 (98%)] Loss: 5.257913: : 65it [00:15,  4.15it/s]
  3%|████▎                                                                                                                                           | 2/66 [00:00<00:23,  2.74it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.71it/s]
0it [00:00, ?it/s]
R@1 : 68.349
R@2 : 78.342
R@4 : 86.158
R@8 : 91.813
R@16 : 95.645







Train Epoch: 37 [65/65 (98%)] Loss: 5.288087: : 65it [00:16,  4.05it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]









100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.72it/s]
R@1 : 68.214
R@2 : 78.190
R@4 : 86.377
R@8 : 91.880
R@16 : 95.392
R@32 : 97.248






Train Epoch: 38 [65/65 (98%)] Loss: 5.407252: : 65it [00:15,  4.10it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]
0it [00:00, ?it/s]
R@1 : 68.113
R@2 : 78.224
R@4 : 86.259
R@8 : 91.914
R@16 : 95.527







Train Epoch: 39 [65/65 (98%)] Loss: 5.301631: : 65it [00:16,  4.04it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]









100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]
R@1 : 68.147
R@2 : 78.494
R@4 : 86.462
R@8 : 91.661
R@16 : 95.257
R@32 : 97.367