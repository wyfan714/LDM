
Random Sampling
Train Epoch: 0 [1/65 (0%)] Loss: 16.270393: : 1it [00:00,  1.09it/s]
Training parameters: {'LOG_DIR': '../Proxy_Anchor/Newlogs', 'dataset': 'cub', 'sz_embedding': 512, 'sz_batch': 90, 'nb_epochs': 40, 'gpu_id': 1, 'nb_workers': 2, 'model': 'bn_inception', 'loss': 'Proxy_Anchor', 'optimizer': 'adamw', 'lr': 0.0001, 'mrg_lr': 0.0005, 'weight_decay': 0.0001, 'weight_lambda': 0.3, 'lr_decay_step': 10, 'lr_decay_gamma': 0.5, 'mrg_lr_decay_step': 10, 'mrg_lr_decay_gamma': 0.5, 'alphap': 32.0, 'alphan': 32.0, 'mrg': 0.1, 'IPC': None, 'warm': 1, 'bn_freeze': 1, 'l2_norm': 1, 'remark': '', 'delta': 0.1, 'T': 1.0, 'lam': 1.0}








Train Epoch: 0 [64/65 (97%)] Loss: 12.316158: : 63it [00:16,  4.04it/s]
Train Epoch: 0 [65/65 (98%)] Loss: 12.258901: : 65it [00:17,  3.81it/s]








 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 62/66 [00:17<00:01,  3.59it/s]
R@1 : 50.388
R@2 : 64.146
R@4 : 76.199
R@8 : 85.246
R@16 : 91.796
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:18<00:00,  3.48it/s]







Train Epoch: 1 [59/65 (89%)] Loss: 10.690931: : 59it [00:14,  4.17it/s]
Train Epoch: 1 [65/65 (98%)] Loss: 11.403530: : 65it [00:15,  4.07it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.72it/s]
R@1 : 60.230
R@2 : 72.029
R@4 : 81.229
R@8 : 88.656
R@16 : 93.839
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]







Train Epoch: 2 [62/65 (94%)] Loss: 9.107407: : 62it [00:14,  4.12it/s]
Train Epoch: 2 [65/65 (98%)] Loss: 9.596151: : 65it [00:15,  4.20it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
R@1 : 62.930
R@2 : 73.920
R@4 : 82.816
R@8 : 89.602
R@16 : 94.176
R@32 : 96.962







Train Epoch: 3 [62/65 (94%)] Loss: 8.857490: : 62it [00:15,  4.24it/s]
Train Epoch: 3 [65/65 (98%)] Loss: 8.738894: : 65it [00:16,  4.05it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.79it/s]
R@1 : 64.737
R@2 : 75.912
R@4 : 84.251
R@8 : 90.699
R@16 : 94.514
R@32 : 97.198







Train Epoch: 4 [62/65 (94%)] Loss: 8.361534: : 62it [00:15,  4.26it/s]
Train Epoch: 4 [65/65 (98%)] Loss: 8.307731: : 65it [00:16,  4.02it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.80it/s]
R@1 : 65.918
R@2 : 76.384
R@4 : 84.909
R@8 : 90.463
R@16 : 94.531
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]







Train Epoch: 5 [61/65 (92%)] Loss: 8.432093: : 61it [00:14,  4.13it/s]
Train Epoch: 5 [65/65 (98%)] Loss: 7.902530: : 65it [00:15,  4.08it/s]








 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 65/66 [00:17<00:00,  3.83it/s]
R@1 : 65.682
R@2 : 76.334
R@4 : 84.656
R@8 : 90.226
R@16 : 94.446
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]







Train Epoch: 6 [63/65 (95%)] Loss: 7.524492: : 63it [00:15,  4.16it/s]
Train Epoch: 6 [65/65 (98%)] Loss: 7.330138: : 65it [00:15,  4.09it/s]







 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.88it/s]
R@1 : 67.049

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]
R@4 : 85.668
R@8 : 91.138
R@16 : 94.885
R@32 : 97.029







Train Epoch: 7 [64/65 (97%)] Loss: 6.915316: : 64it [00:15,  4.38it/s]
Train Epoch: 7 [65/65 (98%)] Loss: 6.816468: : 65it [00:16,  4.02it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.71it/s]
R@1 : 66.897
R@2 : 77.330
R@4 : 85.702
R@8 : 91.256
R@16 : 94.784
R@32 : 97.063







Train Epoch: 8 [64/65 (97%)] Loss: 6.912919: : 64it [00:15,  4.44it/s]
Train Epoch: 8 [65/65 (98%)] Loss: 6.783046: : 65it [00:15,  4.09it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
0it [00:00, ?it/s]
R@1 : 66.627
R@2 : 77.330
R@4 : 85.702
R@8 : 91.155
R@16 : 94.683







Train Epoch: 9 [65/65 (98%)] Loss: 6.699907: : 65it [00:15,  4.17it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  4.08it/s]
R@1 : 66.847
R@2 : 77.346
R@4 : 85.246
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.75it/s]
0it [00:00, ?it/s]
R@16 : 94.784







Train Epoch: 10 [65/65 (98%)] Loss: 6.064190: : 65it [00:16,  4.05it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████             | 60/66 [00:15<00:01,  4.32it/s]
R@1 : 66.729
R@2 : 76.975
R@4 : 85.179
R@8 : 90.868
R@16 : 94.632
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.81it/s]







Train Epoch: 11 [58/65 (88%)] Loss: 6.273273: : 58it [00:14,  4.28it/s]
Train Epoch: 11 [65/65 (98%)] Loss: 6.179975: : 65it [00:16,  4.05it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.84it/s]
R@1 : 67.269
R@2 : 77.616
R@4 : 85.668
R@8 : 91.239
R@16 : 95.172
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]







Train Epoch: 12 [59/65 (89%)] Loss: 6.029725: : 59it [00:14,  4.13it/s]
Train Epoch: 12 [65/65 (98%)] Loss: 6.157770: : 65it [00:16,  4.05it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.83it/s]
R@1 : 67.269
R@2 : 77.853
R@4 : 85.517
R@8 : 91.323
R@16 : 95.307
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]







Train Epoch: 13 [61/65 (92%)] Loss: 5.845848: : 61it [00:14,  4.16it/s]
Train Epoch: 13 [65/65 (98%)] Loss: 5.983400: : 65it [00:15,  4.11it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.84it/s]
R@1 : 67.505
R@2 : 77.752
R@4 : 85.770
R@8 : 91.408
R@16 : 95.409
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]







Train Epoch: 14 [60/65 (91%)] Loss: 5.862868: : 60it [00:14,  4.40it/s]
Train Epoch: 14 [65/65 (98%)] Loss: 6.030885: : 65it [00:16,  4.06it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.76it/s]
R@1 : 67.252
R@2 : 77.954
R@4 : 86.209
R@8 : 91.560
R@16 : 95.189
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]







Train Epoch: 15 [60/65 (91%)] Loss: 5.941866: : 60it [00:14,  4.31it/s]
Train Epoch: 15 [65/65 (98%)] Loss: 5.875703: : 65it [00:16,  4.03it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.79it/s]
R@1 : 67.725
R@2 : 78.646
R@4 : 86.209
R@8 : 91.458
R@16 : 95.645
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]







Train Epoch: 16 [62/65 (94%)] Loss: 5.932887: : 62it [00:15,  4.31it/s]
Train Epoch: 16 [65/65 (98%)] Loss: 6.122066: : 65it [00:15,  4.09it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:17<00:00,  3.79it/s]
R@1 : 68.349
R@2 : 78.393
R@4 : 86.546
R@8 : 91.847
R@16 : 95.223
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.67it/s]







Train Epoch: 17 [60/65 (91%)] Loss: 5.707177: : 60it [00:14,  4.31it/s]
Train Epoch: 17 [65/65 (98%)] Loss: 5.670695: : 65it [00:15,  4.08it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.73it/s]
R@1 : 67.302
R@2 : 78.072
R@4 : 86.090
R@8 : 91.931
R@16 : 95.341
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.84it/s]







Train Epoch: 18 [62/65 (94%)] Loss: 5.595934: : 62it [00:14,  4.24it/s]
Train Epoch: 18 [65/65 (98%)] Loss: 5.854460: : 65it [00:15,  4.13it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.84it/s]
R@1 : 67.167
R@2 : 77.735
R@4 : 85.989
R@8 : 91.627
R@16 : 95.071
R@32 : 97.468







Train Epoch: 19 [63/65 (95%)] Loss: 5.754759: : 63it [00:15,  4.12it/s]
Train Epoch: 19 [65/65 (98%)] Loss: 5.768090: : 65it [00:16,  4.01it/s]








100%|██████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]
R@1 : 66.813
R@2 : 77.346
R@4 : 85.652
R@8 : 91.712
R@16 : 95.155
R@32 : 97.333







Train Epoch: 20 [63/65 (95%)] Loss: 5.636297: : 63it [00:15,  4.10it/s]
Train Epoch: 20 [65/65 (98%)] Loss: 5.625495: : 65it [00:16,  4.01it/s]








100%|██████████████████████████████████████████| 66/66 [00:17<00:00,  3.82it/s]
R@1 : 67.488
R@2 : 78.427
R@4 : 85.635
R@8 : 91.847
R@16 : 95.307
R@32 : 97.485






Train Epoch: 21 [65/65 (98%)] Loss: 5.509799: : 65it [00:15,  4.16it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 59/66 [00:15<00:01,  3.89it/s]
R@1 : 67.876
R@2 : 78.325
R@4 : 86.226

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
R@16 : 95.560
R@32 : 97.535






Train Epoch: 22 [65/65 (98%)] Loss: 5.422402: : 65it [00:15,  4.09it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]
0it [00:00, ?it/s]
R@1 : 67.691
R@2 : 78.342
R@4 : 86.293
R@8 : 91.813
R@16 : 95.409







Train Epoch: 23 [65/65 (98%)] Loss: 5.671963: : 65it [00:15,  4.17it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 62/66 [00:16<00:01,  3.97it/s]
R@1 : 67.302
R@2 : 78.055
R@4 : 86.394
R@8 : 92.100
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
Train Epoch: 24 [1/65 (0%)] Loss: 5.743906: : 1it [00:00,  1.38it/s]







Train Epoch: 24 [65/65 (98%)] Loss: 5.866626: : 65it [00:16,  4.03it/s]
  2%|██▏                                                                                                                                             | 1/66 [00:00<00:42,  1.53it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.68it/s]
R@1 : 68.113
R@2 : 78.747
R@4 : 86.631
R@8 : 91.948
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
Train Epoch: 25 [1/65 (0%)] Loss: 5.514399: : 1it [00:00,  1.33it/s]







Train Epoch: 25 [65/65 (98%)] Loss: 5.639567: : 65it [00:15,  4.07it/s]
  2%|██▏                                                                                                                                             | 1/66 [00:00<00:42,  1.53it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.78it/s]
R@1 : 67.032
R@2 : 77.988
R@4 : 86.006
R@8 : 91.779
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]
Train Epoch: 26 [2/65 (2%)] Loss: 5.421452: : 2it [00:00,  2.38it/s]







Train Epoch: 26 [65/65 (98%)] Loss: 5.612084: : 65it [00:16,  4.05it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 61/66 [00:16<00:01,  3.78it/s]
R@1 : 67.708
R@2 : 78.292
R@4 : 86.344
R@8 : 92.049
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.76it/s]
0it [00:00, ?it/s]







Train Epoch: 27 [60/65 (91%)] Loss: 5.677900: : 60it [00:14,  4.43it/s]
Train Epoch: 27 [65/65 (98%)] Loss: 5.369325: : 65it [00:15,  4.11it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.87it/s]
R@1 : 67.573
R@2 : 78.410
R@4 : 86.175
R@8 : 92.134
R@16 : 95.577
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]







Train Epoch: 28 [61/65 (92%)] Loss: 5.747872: : 61it [00:15,  4.16it/s]
Train Epoch: 28 [65/65 (98%)] Loss: 5.624115: : 65it [00:16,  4.03it/s]








 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 63/66 [00:16<00:00,  3.75it/s]
R@1 : 66.948
R@2 : 78.157
R@4 : 86.074
R@8 : 91.931
R@16 : 95.510
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]







Train Epoch: 29 [62/65 (94%)] Loss: 5.542088: : 62it [00:15,  4.17it/s]
Train Epoch: 29 [65/65 (98%)] Loss: 5.651532: : 65it [00:16,  4.03it/s]








100%|██████████████████████████████████████████| 66/66 [00:16<00:00,  3.88it/s]
R@1 : 67.556
R@2 : 78.359
R@4 : 85.989
R@8 : 91.610
R@16 : 95.206
R@32 : 97.350







Train Epoch: 30 [65/65 (98%)] Loss: 5.527502: : 65it [00:15,  4.07it/s]
**Evaluating...**








100%|██████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
R@1 : 67.573
R@2 : 78.410
R@4 : 86.259
R@8 : 91.695
R@16 : 95.358
R@32 : 97.451







Train Epoch: 31 [64/65 (97%)] Loss: 5.437382: : 64it [00:15,  4.07it/s]
Train Epoch: 31 [65/65 (98%)] Loss: 5.491193: : 65it [00:15,  4.11it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
R@1 : 67.505
R@2 : 78.190
R@4 : 86.209
R@8 : 91.847
R@16 : 95.240
R@32 : 97.400







Train Epoch: 32 [64/65 (97%)] Loss: 5.506415: : 64it [00:15,  4.31it/s]
Train Epoch: 32 [65/65 (98%)] Loss: 5.565793: : 65it [00:16,  4.04it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.80it/s]
0it [00:00, ?it/s]
R@1 : 67.910
R@2 : 78.376
R@4 : 86.090
R@8 : 91.779
R@16 : 95.223







Train Epoch: 33 [65/65 (98%)] Loss: 5.641646: : 65it [00:16,  4.04it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
0it [00:00, ?it/s]
R@1 : 67.201
R@2 : 78.275
R@4 : 86.698
R@8 : 91.914
R@16 : 95.223








Train Epoch: 34 [64/65 (97%)] Loss: 5.716756: : 64it [00:15,  4.10it/s]
Train Epoch: 34 [65/65 (98%)] Loss: 5.435555: : 65it [00:16,  4.01it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.82it/s]
0it [00:00, ?it/s]
R@1 : 66.999
R@2 : 78.494
R@4 : 86.192
R@8 : 91.880
R@16 : 95.544







Train Epoch: 35 [65/65 (98%)] Loss: 5.493586: : 65it [00:16,  4.04it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.83it/s]
0it [00:00, ?it/s]
R@1 : 67.083
R@2 : 78.275
R@4 : 86.648
R@8 : 91.965
R@16 : 95.425







Train Epoch: 36 [65/65 (98%)] Loss: 5.361127: : 65it [00:16,  4.05it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]









100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.72it/s]
R@1 : 67.539
R@2 : 78.460
R@4 : 86.141
R@8 : 92.083
R@16 : 95.527
R@32 : 97.468






Train Epoch: 37 [65/65 (98%)] Loss: 5.443820: : 65it [00:15,  4.13it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.78it/s]
0it [00:00, ?it/s]
R@1 : 66.880
R@2 : 77.903
R@4 : 86.074
R@8 : 91.712
R@16 : 95.594







Train Epoch: 38 [65/65 (98%)] Loss: 5.541716: : 65it [00:15,  4.09it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.68it/s]
0it [00:00, ?it/s]
R@1 : 67.066
R@2 : 78.005
R@4 : 86.057
R@8 : 91.880
R@16 : 95.510







Train Epoch: 39 [65/65 (98%)] Loss: 5.453437: : 65it [00:16,  4.03it/s]
  0%|                                                                                                                                                        | 0/66 [00:00<?, ?it/s]









100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:17<00:00,  3.77it/s]
R@1 : 67.775
R@2 : 77.752
R@4 : 85.989
R@8 : 91.847
R@16 : 95.442
R@32 : 97.468